(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{24:function(e,t){},30:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(10),i=n.n(a),o=n(2),u=n.n(o),s=n(3),l=n(5),d=(n(30),n(6)),b=n(0),j=Object(d.b)((function(e){return{notification:e.notification}}))((function(e){var t=e.notification.text,n=e.notification.num,r="error".concat(n);return null===t?null:Object(b.jsx)("div",{className:r,id:"error",children:t})})),f=function(e){var t=e.user,n=e.blog,c=e.updateLikes,a=e.removeBlog,i=Object(r.useState)(!1),o=Object(l.a)(i,2),u=o[0],s=o[1];return Object(b.jsx)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid Violet",borderWidth:1,marginBottom:5},className:"blog",children:!1===u?Object(b.jsx)("div",{id:"blog1",children:Object(b.jsx)("span",{children:Object(b.jsxs)("div",{children:[" ",n.title,Object(b.jsxs)("b",{children:[" ",n.author]}),Object(b.jsx)("button",{type:"button",onClick:function(){return s(!0)},children:"view"})]})})}):Object(b.jsx)("div",{id:"blog1",children:Object(b.jsx)("span",{children:Object(b.jsxs)("div",{children:[" ",n.title,Object(b.jsxs)("b",{children:[" ",n.author]}),Object(b.jsx)("button",{type:"button",onClick:function(){return s(!1)},children:"hide"}),Object(b.jsxs)("div",{children:[Object(b.jsx)("u",{children:n.url}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{id:"likes",children:["likes ",n.likes,Object(b.jsx)("button",{id:"like",type:"button",onClick:c,children:"like"})]}),n.user.name]}),t.name===n.user.name?Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"remove_button",type:"button",onClick:a,children:"remove"})}):Object(b.jsx)("div",{})]})})})})},p=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(l.a)(n,2),a=c[0],i=c[1],o={display:a?"none":""},u={display:a?"":"none"},s=function(){i(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:o,children:Object(b.jsx)("button",{onClick:s,children:e.buttonLabel})}),Object(b.jsxs)("div",{style:u,className:"togglableContent",children:[e.children,Object(b.jsx)("button",{onClick:s,children:"cancel"})]})]})}));p.displayName="Togglable";var O=p,v=function(e){var t=e.createBlog,n=Object(r.useState)(""),c=Object(l.a)(n,2),a=c[0],i=c[1],o=Object(r.useState)(""),u=Object(l.a)(o,2),s=u[0],d=u[1],j=Object(r.useState)(""),f=Object(l.a)(j,2),p=f[0],O=f[1];return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"create new"}),Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:a,author:s,url:p}),i(""),d(""),O("")},id:"send",children:[Object(b.jsxs)("div",{children:["title",Object(b.jsx)("input",{id:"title",type:"text",value:a,name:"title",onChange:function(e){var t=e.target;return i(t.value)}})]}),Object(b.jsxs)("div",{children:["author",Object(b.jsx)("input",{id:"author",type:"text",value:s,name:"author",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(b.jsxs)("div",{children:["url",Object(b.jsx)("input",{id:"url",type:"text",value:p,name:"url",onChange:function(e){var t=e.target;return O(t.value)}})]}),Object(b.jsx)("button",{id:"create",type:"subbmit",children:"create"})]})]})},h={text:null,IDt:null,num:1},x=function(e,t,n){return function(){var r=Object(s.a)(u.a.mark((function r(c){var a;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=setTimeout((function(){c({type:"NEW_NOTIFICATION",data:{text:null,IDt:a,num:1}})}),1e3*t),c({type:"NEW_NOTIFICATION",data:{text:e,IDt:a,num:n}});case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_NOTIFICATION":return clearTimeout(e.IDt),t.data;default:return e}},m=n(8),w=n(7),y=n.n(w),k="api/blogs",N=null,I=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(k);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,y.a.post(k,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,y.a.put("".concat(k,"/").concat(t.id),Object(m.a)(Object(m.a)({},t),{},{likes:t.likes+1}),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T={getAll:I,setToken:function(e){N="bearer ".concat(e)},create:S,update:function(e,t){return y.a.put("".concat(k,"/").concat(e),t).then((function(e){return e.data}))},remove:function(){var e=Object(s.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,y.a.delete("".concat(k,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),like:C},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("state now: ",e),console.log("action",t),t.type){case"LIKE":return e.map((function(e){return e.id===t.data.id?Object(m.a)(Object(m.a)({},e),{},{likes:e.likes+1}):e}));case"NEW_BLOG":return e.concat(t.data);case"INIT_BLOGS":return t.data;case"REMOVE":return console.log(e.filter((function(e){return e.id!==t.data.id}))),e.filter((function(e){return e.id!==t.data}));default:return e}},B={setNotification:x,createBlog:function(e){return function(){var t=Object(s.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.create(e);case 2:r=t.sent,n({type:"NEW_BLOG",data:Object(m.a)({},r)});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},like:function(e){return function(){var t=Object(s.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.like(e);case 2:n({type:"LIKE",data:Object(m.a)({},e)});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},remove:function(e){return function(){var t=Object(s.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.remove(e);case 2:r=t.sent,console.log(r),n({type:"REMOVE",data:e});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},L=Object(d.b)(null,B)((function(e){var t=Object(d.d)((function(e){return e.blogs})),n=Object(r.useRef)(),c=function(t){console.log(t),n.current.toggleVisibility(),e.createBlog(t),e.setNotification("a new blog '".concat(t.title,"' by ").concat(t.author," added"),5,2)},a=function(){var n=Object(s.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c=t.find((function(e){return e.id===r})),e.like(c);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),i=function(){var n=Object(s.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c=t.find((function(e){return e.id===r})),window.confirm("Remove blog '".concat(c.title,"' by ").concat(c.author))&&(e.remove(r),e.setNotification("Blog '".concat(c.title,"' was succesfully deleted"),5,2));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(b.jsxs)("div",{children:[Object(b.jsx)(O,{buttonLabel:"new blog",ref:n,children:Object(b.jsx)(v,{createBlog:c})}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{id:"blogs",children:t.sort((function(e,t){return e.likes-t.likes})).reverse().map((function(t){return Object(b.jsx)(f,{user:e.user,blog:t,updateLikes:function(){return a(t.id)},removeBlog:function(){return i(t.id)}},t.id)}))})]})})),A={login:function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},D=function(){var e=Object(d.c)();Object(r.useEffect)((function(){e(function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var t=Object(r.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(""),o=Object(l.a)(i,2),f=o[0],p=o[1],O=Object(r.useState)(null),v=Object(l.a)(O,2),h=v[0],g=v[1];Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteappUser");if(e){var t=JSON.parse(e);g(t),T.setToken(t.token)}}),[]);var m=function(){var t=Object(s.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,A.login({username:c,password:f});case 4:r=t.sent,window.localStorage.setItem("loggedNoteappUser",JSON.stringify(r)),e(x("welcome ".concat(c),5,3)),T.setToken(r.token),g(r),a(""),p(""),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),console.log(t.t0.message),e(x("wrong username or password",5,1));case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}(),w=function(){var t=Object(s.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{window.localStorage.removeItem("loggedNoteappUser"),e(x("you logged out... See you next time",5,3)),g(null),a(""),p("")}catch(r){console.log(r.message),e(x("logout failed",5,1))}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return null===h?Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"log in to application"}),Object(b.jsx)(j,{}),Object(b.jsxs)("form",{onSubmit:m,children:[Object(b.jsxs)("div",{children:["username",Object(b.jsx)("input",{id:"username",type:"text",value:c,name:"Username",onChange:function(e){var t=e.target;return a(t.value)}})]}),Object(b.jsxs)("div",{children:["password",Object(b.jsx)("input",{id:"password",type:"password",value:f,name:"Password",onChange:function(e){var t=e.target;return p(t.value)}})]}),Object(b.jsx)("button",{id:"login",type:"login",children:"login"})]})]}):Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"blogs"}),Object(b.jsx)(j,{}),Object(b.jsxs)("div",{children:[h.name," logged in",Object(b.jsx)("button",{type:"button",onClick:w,children:"logout"})]}),Object(b.jsx)(L,{user:h})]})},_=n(9),W=n(22),R=n(23),V=n(24),G=n.n(V),J=Object(_.combineReducers)({blogs:E,notification:g,user:G.a}),U=Object(_.createStore)(J,Object(W.composeWithDevTools)(Object(_.applyMiddleware)(R.a)));i.a.render(Object(b.jsx)(d.a,{store:U,children:Object(b.jsx)(D,{})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.d52655c9.chunk.js.map